<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CheckResult.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Javaslang</a> &gt; <a href="index.source.html" class="el_package">javaslang.test</a> &gt; <span class="el_source">CheckResult.java</span></div><h1>CheckResult.java</h1><pre class="source lang-java linenums">/*     / \____  _    ______   _____ / \____   ____  _____
 *    /  \__  \/ \  / \__  \ /  __//  \__  \ /    \/ __  \   Javaslang
 *  _/  // _\  \  \/  / _\  \\_  \/  // _\  \  /\  \__/  /   Copyright 2014-2015 Daniel Dietrich
 * /___/ \_____/\____/\_____/____/\___\_____/_/  \_/____/    Licensed under the Apache License, Version 2.0
 */
package javaslang.test;

import javaslang.Tuple;
import javaslang.control.Option;

import java.io.Serializable;
import java.util.Objects;

/**
 * Represents the result of a property check which is
 *
 * &lt;ul&gt;
 * &lt;li&gt;{@code Satisfied}, if all tests satisfied the given property&lt;/li&gt;
 * &lt;li&gt;{@code Falsified}, if a counter-example could be discovered that falsified the given property&lt;/li&gt;
 * &lt;li&gt;{@code Erroneous}, if an exception occurred executing the property check&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * Please note that a {@code Satisfied} property check may be {@code Exhausted}, if the property is an implication
 * and no sample could be found that satisfied the pre-condition. In this case the post-condition is satisfied by
 * definition (see &lt;a href=&quot;http://en.wikipedia.org/wiki/Principle_of_explosion&quot;&gt;ex falso quodlibet&lt;/a&gt;).
 *
 * @author Daniel Dietrich
 * @since 1.2.0
 */
public interface CheckResult {

    /**
     * If this check result is satisfied as specified above.
     *
     * @return true, if this check result is satisfied, false otherwise
     */
    boolean isSatisfied();

    /**
     * If this check result is falsified as specified above.
     *
     * @return true, if this check result is falsified, false otherwise
     */
    boolean isFalsified();

    /**
     * If this check result is erroneous as specified above.
     *
     * @return true, if this check result is erroneous, false otherwise
     */
    boolean isErroneous();

    /**
     * If this check result is exhausted as specified above.
     *
     * @return true, if this check result is exhausted, false otherwise
     */
    boolean isExhausted();

    /**
     * The name of the checked property this result refers to.
     *
     * @return a property name
     */
    String propertyName();

    /**
     * The number of checks performed using random generated input data.
     *
     * @return the number of checks performed
     */
    int count();

    /**
     * An optional sample which falsified the property or which lead to an error.
     *
     * @return an optional sample
     */
    Option&lt;Tuple&gt; sample();

    /**
     * An optional error.
     *
     * @return an optional error
     * @since 1.2.0
     */
    Option&lt;Error&gt; error();

    /**
     * Asserts that this CheckResult is satisfied.
     *
     * @throws AssertionError if this CheckResult is not satisfied.
     */
    default void assertIsSatisfied() {
<span class="fc bfc" id="L95" title="All 2 branches covered.">        if (!isSatisfied()) {</span>
<span class="fc" id="L96">            throw new AssertionError(&quot;Expected satisfied check result but was &quot; + this);</span>
        }
<span class="fc" id="L98">    }</span>

    /**
     * Asserts that this CheckResult is satisfied with a given exhausted state.
     *
     * @param exhausted The exhausted state to be checked in the case of a satisfied CheckResult.
     * @throws AssertionError if this CheckResult is not satisfied or the exhausted state does not match.
     */
    default void assertIsSatisfiedWithExhaustion(boolean exhausted) {
<span class="fc bfc" id="L107" title="All 2 branches covered.">        if (!isSatisfied()) {</span>
<span class="fc" id="L108">            throw new AssertionError(&quot;Expected satisfied check result but was &quot; + this);</span>
<span class="fc bfc" id="L109" title="All 2 branches covered.">        } else if (isExhausted() != exhausted) {</span>
<span class="fc bfc" id="L110" title="All 2 branches covered.">            throw new AssertionError(&quot;Expected satisfied check result to be &quot; + (exhausted ? &quot;&quot; : &quot;not &quot;) + &quot;exhausted but was: &quot; + this);</span>
        }
<span class="fc" id="L112">    }</span>

    /**
     * Asserts that this CheckResult is falsified.
     *
     * @throws AssertionError if this CheckResult is not falsified.
     */
    default void assertIsFalsified() {
<span class="fc bfc" id="L120" title="All 2 branches covered.">        if (!isFalsified()) {</span>
<span class="fc" id="L121">            throw new AssertionError(&quot;Expected falsified check result but was &quot; + this);</span>
        }
<span class="fc" id="L123">    }</span>

    /**
     * Asserts that this CheckResult is erroneous.
     *
     * @throws AssertionError if this CheckResult is not erroneous.
     */
    default void assertIsErroneous() {
<span class="fc bfc" id="L131" title="All 2 branches covered.">        if (!isErroneous()) {</span>
<span class="fc" id="L132">            throw new AssertionError(&quot;Expected erroneous check result but was &quot; + this);</span>
        }
<span class="fc" id="L134">    }</span>

    /**
     * Represents a satisfied property check.
     */
    class Satisfied implements CheckResult, Serializable {

        private static final long serialVersionUID = 1L;

        private final String propertyName;
        private final int count;
        private final boolean exhausted;

<span class="fc" id="L147">        Satisfied(String propertyName, int count, boolean exhausted) {</span>
<span class="fc" id="L148">            this.propertyName = propertyName;</span>
<span class="fc" id="L149">            this.count = count;</span>
<span class="fc" id="L150">            this.exhausted = exhausted;</span>
<span class="fc" id="L151">        }</span>

        @Override
        public boolean isSatisfied() {
<span class="fc" id="L155">            return true;</span>
        }

        @Override
        public boolean isFalsified() {
<span class="fc" id="L160">            return false;</span>
        }

        @Override
        public boolean isErroneous() {
<span class="fc" id="L165">            return false;</span>
        }

        @Override
        public boolean isExhausted() {
<span class="fc" id="L170">            return exhausted;</span>
        }

        @Override
        public String propertyName() {
<span class="fc" id="L175">            return propertyName;</span>
        }

        @Override
        public int count() {
<span class="fc" id="L180">            return count;</span>
        }

        @Override
        public Option&lt;Tuple&gt; sample() {
<span class="fc" id="L185">            return Option.none();</span>
        }

        @Override
        public Option&lt;Error&gt; error() {
<span class="fc" id="L190">            return Option.none();</span>
        }

        @Override
        public boolean equals(Object o) {
<span class="fc bfc" id="L195" title="All 2 branches covered.">            if (o == this) {</span>
<span class="fc" id="L196">                return true;</span>
<span class="fc bfc" id="L197" title="All 2 branches covered.">            } else if (o instanceof Satisfied) {</span>
<span class="fc" id="L198">                final Satisfied that = (Satisfied) o;</span>
<span class="pc bpc" id="L199" title="2 of 6 branches missed.">                return Objects.equals(this.propertyName, that.propertyName)</span>
                        &amp;&amp; this.count == that.count
                        &amp;&amp; this.exhausted == that.exhausted;
            } else {
<span class="fc" id="L203">                return false;</span>
            }
        }

        @Override
        public int hashCode() {
<span class="fc" id="L209">            return Objects.hash(propertyName, count, exhausted);</span>
        }

        @Override
        public String toString() {
<span class="fc" id="L214">            return String.format(&quot;%s(propertyName = %s, count = %s, exhausted = %s)&quot;, getClass().getSimpleName(), propertyName, count, exhausted);</span>
        }
    }

    /**
     * Represents a falsified property check.
     *
     * @since 1.2.0
     */
    class Falsified implements CheckResult, Serializable {

        private static final long serialVersionUID = 1L;

        private final String propertyName;
        private final int count;
        private final Tuple sample;

<span class="fc" id="L231">        Falsified(String propertyName, int count, Tuple sample) {</span>
<span class="fc" id="L232">            this.propertyName = propertyName;</span>
<span class="fc" id="L233">            this.count = count;</span>
<span class="fc" id="L234">            this.sample = sample;</span>
<span class="fc" id="L235">        }</span>

        @Override
        public boolean isSatisfied() {
<span class="fc" id="L239">            return false;</span>
        }

        @Override
        public boolean isFalsified() {
<span class="fc" id="L244">            return true;</span>
        }

        @Override
        public boolean isErroneous() {
<span class="fc" id="L249">            return false;</span>
        }

        @Override
        public boolean isExhausted() {
<span class="fc" id="L254">            return false;</span>
        }

        @Override
        public String propertyName() {
<span class="fc" id="L259">            return propertyName;</span>
        }

        @Override
        public int count() {
<span class="fc" id="L264">            return count;</span>
        }

        @Override
        public Option&lt;Tuple&gt; sample() {
<span class="fc" id="L269">            return Option.some(sample);</span>
        }

        @Override
        public Option&lt;Error&gt; error() {
<span class="fc" id="L274">            return Option.none();</span>
        }

        @Override
        public boolean equals(Object o) {
<span class="fc bfc" id="L279" title="All 2 branches covered.">            if (o == this) {</span>
<span class="fc" id="L280">                return true;</span>
<span class="fc bfc" id="L281" title="All 2 branches covered.">            } else if (o instanceof Falsified) {</span>
<span class="fc" id="L282">                final Falsified that = (Falsified) o;</span>
<span class="pc bpc" id="L283" title="1 of 4 branches missed.">                return Objects.equals(this.propertyName, that.propertyName)</span>
                        &amp;&amp; this.count == that.count
<span class="pc bpc" id="L285" title="1 of 2 branches missed.">                        &amp;&amp; Objects.equals(this.sample, that.sample);</span>
            } else {
<span class="fc" id="L287">                return false;</span>
            }
        }

        @Override
        public int hashCode() {
<span class="fc" id="L293">            return Objects.hash(propertyName, count, sample);</span>
        }

        @Override
        public String toString() {
<span class="fc" id="L298">            return String.format(&quot;%s(propertyName = %s, count = %s, sample = %s)&quot;, getClass().getSimpleName(), propertyName, count, sample);</span>
        }
    }

    /**
     * Represents an erroneous property check.
     *
     * @since 1.2.0
     */
    class Erroneous implements CheckResult, Serializable {

        private static final long serialVersionUID = 1L;

        private final String propertyName;
        private final int count;
        private final Error error;
        private final Option&lt;Tuple&gt; sample;

<span class="fc" id="L316">        Erroneous(String propertyName, int count, Error error, Option&lt;Tuple&gt; sample) {</span>
<span class="fc" id="L317">            this.propertyName = propertyName;</span>
<span class="fc" id="L318">            this.count = count;</span>
<span class="fc" id="L319">            this.error = error;</span>
<span class="fc" id="L320">            this.sample = sample;</span>
<span class="fc" id="L321">        }</span>

        @Override
        public boolean isSatisfied() {
<span class="fc" id="L325">            return false;</span>
        }

        @Override
        public boolean isFalsified() {
<span class="fc" id="L330">            return false;</span>
        }

        @Override
        public boolean isErroneous() {
<span class="fc" id="L335">            return true;</span>
        }

        @Override
        public boolean isExhausted() {
<span class="fc" id="L340">            return false;</span>
        }

        @Override
        public String propertyName() {
<span class="fc" id="L345">            return propertyName;</span>
        }

        @Override
        public int count() {
<span class="fc" id="L350">            return count;</span>
        }

        @Override
        public Option&lt;Tuple&gt; sample() {
<span class="fc" id="L355">            return sample;</span>
        }

        @Override
        public Option&lt;Error&gt; error() {
<span class="fc" id="L360">            return Option.some(error);</span>
        }

        @Override
        public boolean equals(Object o) {
<span class="fc bfc" id="L365" title="All 2 branches covered.">            if (o == this) {</span>
<span class="fc" id="L366">                return true;</span>
<span class="fc bfc" id="L367" title="All 2 branches covered.">            } else if (o instanceof Erroneous) {</span>
<span class="fc" id="L368">                final Erroneous that = (Erroneous) o;</span>
<span class="pc bpc" id="L369" title="1 of 4 branches missed.">                return Objects.equals(this.propertyName, that.propertyName)</span>
                        &amp;&amp; this.count == that.count
<span class="pc bpc" id="L371" title="1 of 2 branches missed.">                        &amp;&amp; deepEquals(this.error, that.error)</span>
<span class="pc bpc" id="L372" title="1 of 2 branches missed.">                        &amp;&amp; Objects.equals(this.sample, that.sample);</span>
            } else {
<span class="fc" id="L374">                return false;</span>
            }
        }

        boolean deepEquals(Throwable t1, Throwable t2) {
<span class="pc bpc" id="L379" title="3 of 8 branches missed.">            return (t1 == null &amp;&amp; t2 == null) || (</span>
                    t1 != null &amp;&amp; t2 != null
<span class="pc bpc" id="L381" title="1 of 2 branches missed.">                            &amp;&amp; Objects.equals(t1.getMessage(), t2.getMessage())</span>
<span class="pc bpc" id="L382" title="1 of 2 branches missed.">                            &amp;&amp; deepEquals(t1.getCause(), t2.getCause())</span>
            );
        }

        @Override
        public int hashCode() {
<span class="fc" id="L388">            return Objects.hash(propertyName, count, deepHashCode(error), sample);</span>
        }

        int deepHashCode(Throwable t) {
<span class="fc bfc" id="L392" title="All 2 branches covered.">            if (t == null) {</span>
<span class="fc" id="L393">                return 0;</span>
            } else {
<span class="fc" id="L395">                return Objects.hash(t.getMessage(), deepHashCode(t.getCause()));</span>
            }
        }

        @Override
        public String toString() {
<span class="fc" id="L401">            return String.format(&quot;%s(propertyName = %s, count = %s, error = %s, sample = %s)&quot;, getClass().getSimpleName(), propertyName, count, error.getMessage(), sample);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>